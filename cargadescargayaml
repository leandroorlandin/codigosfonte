import yaml
import jsonref


def resolve_references(yaml_data):
    yaml_data = yaml.load(yaml_data, Loader=yaml.SafeLoader)
    resolved_data = jsonref.JsonRef.replace_refs(yaml_data)
    return yaml.dump(resolved_data)


# Leitura do arquivo OpenAPI YAML
with open("openAPI.yaml", "r") as file:
    yaml_data = file.read()

# Resolução das referências e geração do arquivo compilado
resolved_data = resolve_references(yaml_data)

# Escrita do arquivo compilado
with open("openAPI-compiled.yaml", "w") as file:
    file.write(resolved_data)

print("Arquivo compilado salvo com sucesso!")
