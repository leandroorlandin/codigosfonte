import ruamel.yaml
from ruamel.yaml.resolver import Resolver

def resolve_references(data):
    resolver = Resolver()
    resolver.resolve(data)
    return data

def process_openapi(input_file, output_file):
    with open(input_file, "r") as f:
        yaml_data = ruamel.yaml.round_trip_load(f, preserve_quotes=True)
    
    resolved_data = resolve_references(yaml_data)
    
    with open(output_file, "w") as f:
        ruamel.yaml.round_trip_dump(resolved_data, f)

input_file = "openAPI.yaml"
output_file = "openAPI-compiled.yaml"

process_openapi(input_file, output_file)
