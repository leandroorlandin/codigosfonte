import ruamel.yaml
import jsonschema

def resolve_references(yaml_data):
    resolver = jsonschema.RefResolver.from_schema(yaml_data)
    return resolver.resolve(yaml_data)

def process_openapi(input_file, output_file):
    with open(input_file, "r") as f:
        yaml_data = ruamel.yaml.safe_load(f)
    
    resolved_data = resolve_references(yaml_data)
    
    with open(output_file, "w") as f:
        ruamel.yaml.dump(resolved_data, f)

input_file = "openAPI.yaml"
output_file = "openAPI-compiled.yaml"

process_openapi(input_file, output_file)

